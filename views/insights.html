<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insights - Canyon</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/insights.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta name="description" content="CPQ Analytics and Insights - Track performance metrics and approval workflows.">
</head>
<body class="insights-page">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <div class="logo-icon">
                    <i class="fas fa-mountain-sun"></i>
                </div>
                <span class="logo-text">Canyon</span>
            </div>
            <div class="nav-menu">
                <a href="/" class="nav-link">Home</a>
                <a href="/dashboard" class="nav-link">Dashboard</a>
                <a href="/quotes" class="nav-link">Quotes</a>
                <a href="/quotes/create/" class="nav-link">Create Quote</a>
                <a href="/insights" class="nav-link">Insights</a>
                <button class="nav-cta" id="userMenu">
                    <i class="fas fa-user"></i>
                    <span id="userName">Loading...</span>
                </button>
            </div>
            <div class="mobile-menu-toggle" id="mobileToggle">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </nav>

    <!-- Insights Layout Container -->
    <div class="insights-layout">
        <!-- Sidebar Navigation -->
        <aside class="insights-sidebar">
            <nav class="sidebar-nav">
                <div class="nav-tab" data-tab="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </div>
                <div class="nav-tab" data-tab="quotes">
                    <i class="fas fa-file-invoice"></i>
                    <span>Quotes</span>
                </div>
                <div class="nav-tab" data-tab="create-quotes">
                    <i class="fas fa-plus-circle"></i>
                    <span>Create Quote</span>
                </div>
                <div class="nav-tab active" data-tab="analytics">
                    <i class="fas fa-chart-bar"></i>
                    <span>Analytics</span>
                </div>
                <div class="nav-tab" data-tab="support">
                    <i class="fas fa-life-ring"></i>
                    <span>Support</span>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="insights-main">
            <div class="insights-container">
                <!-- Page Header -->
                <div class="page-header">
                    <div class="header-content">
                        <div class="header-text">
                            <h1>
                                <i class="fas fa-chart-line"></i>
                                CPQ Insights & Analytics
                            </h1>
                            <p>Track performance metrics, approval workflows, and business intelligence</p>
                        </div>
                        <div class="header-actions">
                            <button class="btn-secondary" id="exportData">
                                <i class="fas fa-download"></i>
                                Export Report
                            </button>
                            <button class="btn-primary" id="refreshData">
                                <i class="fas fa-sync-alt"></i>
                                Refresh Data
                            </button>
                        </div>
                    </div>
                    
                    <!-- Time Range Filter -->
                    <div class="time-filter">
                        <div class="filter-group">
                            <label>Time Range:</label>
                            <select id="timeRange" class="filter-select">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d" selected>Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                                <option value="1y">Last Year</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Key Metrics Overview -->
                <div class="metrics-overview">
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="avgApprovalTime">4.2 days</div>
                            <div class="metric-label">Avg. Approval Time</div>
                            <div class="metric-change positive">
                                <i class="fas fa-arrow-down"></i>
                                <span>12% faster</span>
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="approvalRate">87%</div>
                            <div class="metric-label">Approval Rate</div>
                            <div class="metric-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+3.2%</span>
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="avgDealSize">$245K</div>
                            <div class="metric-label">Avg. Deal Size</div>
                            <div class="metric-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+18%</span>
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="activeUsers">24</div>
                            <div class="metric-label">Active Users</div>
                            <div class="metric-change neutral">
                                <i class="fas fa-minus"></i>
                                <span>No change</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="charts-grid">
                    <!-- Approval Time by Persona -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>
                                <i class="fas fa-stopwatch"></i>
                                Avg. Approval Time by Role
                            </h3>
                            <div class="chart-actions">
                                <button class="chart-action-btn" title="View Details">
                                    <i class="fas fa-expand"></i>
                                </button>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="approvalTimeChart"></canvas>
                        </div>
                    </div>

                    <!-- Quotes by Stage -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>
                                <i class="fas fa-funnel-dollar"></i>
                                Quotes by Stage
                            </h3>
                            <div class="chart-actions">
                                <button class="chart-action-btn" title="View Details">
                                    <i class="fas fa-expand"></i>
                                </button>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="quotesByStageChart"></canvas>
                        </div>
                    </div>

                    <!-- Approval vs Rejection Rate -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>
                                <i class="fas fa-chart-pie"></i>
                                Approval vs Rejection Rate
                            </h3>
                            <div class="chart-actions">
                                <button class="chart-action-btn" title="View Details">
                                    <i class="fas fa-expand"></i>
                                </button>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="approvalRateChart"></canvas>
                        </div>
                    </div>

                    <!-- Revenue Trend -->
                    <div class="chart-card large">
                        <div class="chart-header">
                            <h3>
                                <i class="fas fa-chart-line"></i>
                                Revenue Trend & Pipeline
                            </h3>
                            <div class="chart-actions">
                                <button class="chart-action-btn" title="View Details">
                                    <i class="fas fa-expand"></i>
                                </button>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="revenueTrendChart"></canvas>
                        </div>
                    </div>

                    <!-- Top Performers -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>
                                <i class="fas fa-trophy"></i>
                                Top Performers
                            </h3>
                        </div>
                        <div class="chart-content">
                            <div class="performers-list" id="performersList">
                                <!-- Will be populated by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Bottleneck Analysis -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>
                                <i class="fas fa-exclamation-triangle"></i>
                                Workflow Bottlenecks
                            </h3>
                        </div>
                        <div class="chart-content">
                            <div class="bottlenecks-list" id="bottlenecksList">
                                <!-- Will be populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Tables -->
                <div class="tables-section">
                    <div class="table-card">
                        <div class="table-header">
                            <h3>
                                <i class="fas fa-table"></i>
                                Recent Quote Performance
                            </h3>
                            <div class="table-actions">
                                <button class="btn-secondary btn-sm" id="exportTable">
                                    <i class="fas fa-file-csv"></i>
                                    Export CSV
                                </button>
                            </div>
                        </div>
                        <div class="table-content">
                            <div class="table-wrapper">
                                <table class="performance-table" id="performanceTable">
                                    <thead>
                                        <tr>
                                            <th>Quote ID</th>
                                            <th>Customer</th>
                                            <th>Amount</th>
                                            <th>Current Stage</th>
                                            <th>Days in Stage</th>
                                            <th>Total Time</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Will be populated by JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="insights-footer">
        <div class="container">
            <p>&copy; 2025 Canyon. All rights reserved.</p>
        </div>
    </footer>

    <script src="/js/insights.js"></script>
</body>
</html>
